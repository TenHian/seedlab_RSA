#include<stdio.h>
#include<openssl/bn.h>

void printBN(char *msg,BIGNUM *a)
{
	char* number_str=BN_bn2hex(a);
	printf("%s %s\n",msg,number_str);
	OPENSSL_free(number_str);
}

int main()
{
	BN_CTX *ctx=BN_CTX_new();
	BIGNUM *S=BN_new();//签名
	BIGNUM *n=BN_new();
	BIGNUM *e=BN_new();
	BIGNUM *M=BN_new();//明文16进制
	BIGNUM *Mi=BN_new();//验证

	BN_hex2bn(&M,"8afeec4c6ac9dfb5c5c946fbd43adfa5d7af9d4f8152e18135e2f1d0f0bd8083");
	BN_hex2bn(&n,"C70E6C3F23937FCC70A59D20C30E533F7EC04EC29849CA47D523EF03348574C8A3022E465C0B7DC9889D4F8BF0F89C6C8C5535DBBFF2B3EAFBE356E74A46D91322CA36D59BC1A8E3964393F20CBCE6F9E6E899C86348787F5736691A191D5AD1D47DC29CD47FE18012AE7AEA88EA57D8CA0A0A3A1249A262197A0D24F737EBB473927B05239B12B5CEEB29DFA41402B901A5D4A69C436488DEF87EFEE3F51EE5FEDCA3A8E46631D94C25E918B9895909AEE99D1C6D370F4A1E352028E2AFD4218B01C445AD6E2B63AB926B610A4D20ED73BA7CCEFE16B5DB9F80F0D68B6CD908794A4F7865DA92BCBE35F9B3C4F927804EFF9652E60220E10773E95D2BBDB2F1");
	BN_hex2bn(&S,"bcdc02d0d9de8cc5e2d9fe4defbad1228b34425984923182d50abc4035db06b2136ec8cf01f15fc0e7b734373aa808f29f32d5f920809fbfd3ff6d479c76d1cbf1c7f1db833337e53f18a700e2bddafe4f29455787785f53850db3a35c6393fee0265ef9928ced76a35f39e6220536c53273d0cd51aac8c31fa8ac5b26b7d99460088181d3f5b77a4fdf39215833b51563028cb822ead97a74ec5a41bb3da7c9e24021ea341a4aed736046c7963b99e4f5e59213cef43c16d5620fba0e99ae5ca52d34d89a55b75844ce0138bbd0762c64de8d002b99e2dd6110edc0b05ee5aa3740d87c13375d055f61ee694bdfe4eccff8f2aea55f552b0f31f2640a53abeb");
	BN_hex2bn(&e,"010001");

	printBN("M原文:",M);

	//验证	S^e mod n
	BN_mod_exp(Mi,S,e,n,ctx);
	printBN("Mi验证:",Mi);

	return 0;
}